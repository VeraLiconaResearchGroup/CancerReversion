<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Clustering Attractors</title>
    <meta name="description" content="This is my lab notebook for my undergraduate honors thesis in Dr. Paola Vera-Licona's Computational Systems Medicine Research Group.
">

    <link rel="stylesheet" href="http://localhost:4000/gastonguay_compsysmed_labnotebook/css/main.css">
    <link rel="canonical" href="http://localhost:4000/gastonguay_compsysmed_labnotebook/_projects/project2/2019/07/19/attractor-clustering.html">

<!-- meta robots -->
    
     	<meta name="robots" content="noindex" />
    

<!-- loading fonts -->
    <!-- Open Sans -->
    <link href="http://localhost:4000/gastonguay_compsysmed_labnotebook/_assets/open_sans/style.css" rel="stylesheet">

    <!-- own icon font, created via https://icomoon.io/  -->
    <link href="http://localhost:4000/gastonguay_compsysmed_labnotebook/_assets/lablogIcons/style.css" rel="stylesheet">

    <!-- Ubuntu Mono for code -->
    <link href="http://localhost:4000/gastonguay_compsysmed_labnotebook/_assets/Ubuntu_Mono/style.css" rel='stylesheet' type='text/css'>

<!-- mathjax.org for math equations -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
    imageFont: null,
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
    tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]} ,
    menuSettings: { context: "Browser" }
    });
    </script>

    <script type="text/javascript"  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>

<!-- highlight.js for code syntax highlighting-->
<link rel="stylesheet" href="http://localhost:4000/gastonguay_compsysmed_labnotebook/_assets/highlight/styles/github.css">
<script src="http://localhost:4000/gastonguay_compsysmed_labnotebook/_assets/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<!--<link rel="stylesheet" href="http://yandex.st/highlightjs/7.3/styles/default.min.css">
<script src="http://yandex.st/highlightjs/7.3/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>-->


</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/gastonguay_compsysmed_labnotebook/index.html">Maddie Gastonguay lab notebook</a>

  <nav  class="main-menu">
  <input type="checkbox" id="menu" />
  <label for="menu"></label>
  <div class="trigger">

    <a class="page-link" href="/gastonguay_compsysmed_labnotebook/index.html"><span style = "font-family: 'lablogIcons';">  &#xe605; </span> Maddie Gastonguay lab notebook</a>

    
      <a class="page-link" href="/gastonguay_compsysmed_labnotebook/tasks.html"><span style = "font-family: 'lablogIcons';">  &#xf046; </span> Tasks</a>
    

    
<a class="page-link" href="/gastonguay_compsysmed_labnotebook/tags.html"><span style = "font-family: 'lablogIcons';">  &#xe600; </span> Tags</a>
    

    
      <a class="page-link" href="/gastonguay_compsysmed_labnotebook/archive.html"><span style = "font-family: 'lablogIcons';">  &#xe602; </span> Archive</a>
    

    <br>

    
      <a class="page-link" href="/gastonguay_compsysmed_labnotebook/about.html">
        <span style = "font-family: 'lablogIcons';">  &#xe60a; </span>
        
        
        About
      </a>
    
      <a class="page-link" href="/gastonguay_compsysmed_labnotebook/_projects/project1/project01.html">
        <span style = "font-family: 'lablogIcons';">  &#xe60a; </span>
        
        
        Preliminary Network For Breast Cancer Reversion
      </a>
    
      <a class="page-link" href="/gastonguay_compsysmed_labnotebook/_projects/project2/project02.html">
        <span style = "font-family: 'lablogIcons';">  &#xe60a; </span>
        
        
        Cancer Reversion in Claudin Low Triple Negative Breast Cancer
      </a>
    

    

    <br>

    
    <div class="menu-content">
      

    </div>
    

    

  </div>

  </nav>


  </div>


</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">Clustering Attractors</h1>
    <p class="post-meta">Jul 19, 2019 • maddie</p>

    
    <div>
     
       <a href="/gastonguay_compsysmed_labnotebook/tags.html#project2" title="Pages tagged project2" rel="tag" class = "tag"> project2 </a>  &nbsp
     
       <a href="/gastonguay_compsysmed_labnotebook/tags.html#static_network" title="Pages tagged static_network" rel="tag" class = "tag"> static_network </a>  &nbsp
     
    </div>
    

  </header>

  <article class="post-content">
    <h1 id="objective">Objective</h1>
<p>Identify those attractors associated to cancerous-like and normal-like phenotypes through clustering methods.</p>

<h2 id="generation-of-data">Generation of Data</h2>

<p>I generated 1,000 random initial states and ran signal flow to get the 1,000 corresponding attractors. From this I constructed 6 datasets:</p>

<ol type="A">
<li>The raw values produced by signal flow rounded to three decimal places</li>
<li>The values produced by signal flow "discretized" so that positive values are 1, negative values are -1, and 0 values remain 0</li>
<li>The direction of activity change (DAC) for each attractor calculated by the difference between the log steady state acttractor for MDA-MB-231 and each attractor</li>
<li>The "discretized" values of the above dataset</li>
<li>The combination of datasets 1 and 3</li>
<li>The combination of datasets 2 and 4</li>
</ol>

<h2 id="clustering-analysis">Clustering Analysis</h2>

<p>For each of the datasets listed above, I ran several different clustering methods on them.</p>

<ol>
  <li>Principle Component Analysis</li>
  <li>Multi-dimensional Scaling</li>
  <li>Hierarchical
    <ul>
      <li>dendrogram and heatmap</li>
    </ul>
  </li>
  <li>K-means
    <ul>
      <li>After a silhouette and elbow plot</li>
    </ul>
  </li>
</ol>

<blockquote>
  <p><strong>Notes:</strong> Goodness of fit for MDS was so bad (&lt;5% for each of first two components) that I didn’t bother looking at what the first two components were. The issue I was having with KNN is that I can an only do KNN with 2 nearest neighbors using this data because we only have two values in the training set.</p>
</blockquote>

<p><img src="/gastonguay_compsysmed_labnotebook\_assets\images_proj2\knn.png" alt="knn" /></p>

<h1 id="identifying-attractors-that-cluster-together">Identifying attractors that cluster together</h1>
<p>Even though I did different clustering methods on different datasets, I only looked at those with “discretized” values because the magnitude doesn’t matter! Of these, I decided to use the dataset with the combo of DAC and raw because the hierarchical and kmeans clustering looked good. I identifed approximately 240 attractors that always cluster with MDA-MB-231 and approximately 445 attractors that always cluster with MCF10A whether you use hierarchical or kmeans with 2 or 3 clusters. This leaves about 320 other attractors, representing neither a cancerous or normal phenotype.</p>

<h2 id="readout-nodes-in-those-clusters">Readout nodes in those clusters</h2>
<p><strong>FYN, HUWE1, MAPK13</strong> were 1 in 99% of the cancerous attractors whereas in the normal attrctors, there was about a 50/50 split between 1s and -1s for these readout nodes. CDC20 was a 1 in 75% of the normal attractors but it was also a 1 in 62% of cancerous attractors - are these frequencies different enough to distinguish the attractors? Two of the other readout nodes: STAT3 and SNAI1 were a 1 in 100% (STAT3) and 96% (SNAI1) of both the cancerous attractors and normal attractors. (aka they had the same frequency in the normal and cancerous attractors)  Lastly, CCNG2 and GSK3B were split pretty evenly between 1s and -1s in both the cancerous and normal attractors meaning they aren’t good readout nodes.</p>

<!-- ## New Readout Nodes?

**Genes that are expressed in at least 70% of the "cancerous" attractors and less than 70% of the time in "normal" attractors:**
- FBLN1
- FYN
- HUWE1
- LRP1
- LTBP3
- MAPT
- MOCOS
- PIAS3
- TAF12
- TBL1X
- SKIL
- MAPK13
- CXXC5
- RASGRF1
- BIRC6
- DNAJB2
- SHC1
- SH3YL1
- CHEK2
- CTNNB1
- ITGB8
- RHOD

**Genes that are expressed in at least 70% of the "normal" attractors and less than 70% of the time in "cancerous" attractors:**
- AURKA
- HMGB2
- BUB1
- KAT2A
- LIMK2
- ROCK1
- SRPK1
- TAF1B
- TPR
- CKAP5
- S100A2
- HMGA2
- SNRPA
- FGF13
- FOXM1
- TACC1
- JUN
- MAD2L2
- RPS6KA1
- TCF3
- CDC20 -->

<h1 id="knn-take-2">Knn Take 2</h1>
<p>I decided to try Knn with the clusters that always cluster with 231 or with 10A as the training set for cancerous and normal, and some of the results from our perturbation analysis as the test case. If we do this, we can compare to more than 2 neighbors, and effectively classify the perturbations as either cancerous or normal.</p>

<h1 id="going-to-do-this-same-analysis-with-100000-attractors">Going to do this same analysis with 100,000 attractors</h1>

<p>TO DO:</p>

<ol>
  <li>Determine which dataset is the best to cluster with</li>
  <li>Pull out cluster assignments for that dataset and the different clustering methods</li>
  <li>Determine the attractors that always cluster with 231 or 10A
    <ul>
      <li>via cluster_patterns.py script</li>
      <li>input: dataframe from (2) with attractors as rows and clustering methods as columns</li>
    </ul>
  </li>
  <li>Next, determine if the nodes in these clusters have similar expression patterns
    <ul>
      <li>via ExploreNodesinClusters.py script</li>
      <li>input: dataframe of atttractors with attrs as rows and nodes as columns</li>
    </ul>
  </li>
  <li>Determine possible readout nodes that are uniform in one cluster but not the other
    <ul>
      <li>via the NewPossibleRONs.py script</li>
    </ul>
  </li>
</ol>

<h2 id="problem-size-issue-with-hclust-function">Problem: Size issue with Hclust function</h2>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Error in hclust(dist(scale(all_T)), method = "complete") : 
  size cannot be NA nor exceed 65536
Execution halted
</code></pre></div></div>

<p>From what I’ve read, hierarchical clustering does not scale well to large data sets because it approaces O(n^2) in runtime and O(n^3) in memory complexity. Also, since I am clustering 100,000 attractors, I am creating a 100,000 x 100,000 distance matrix, which is too large for R.</p>

  </article>

</div>

<div class="related-posts">
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <h3>Related Posts:</h3>
  <ul>
  
  <li class="relatedPost">
  <a href="/gastonguay_compsysmed_labnotebook/_projects/project2/2020/04/05/NetworkAnlysis-final.html">Final Network Analysis
  </a> <span class = "post-meta"> • April  5, 2020</span>
  
  <span class = "post-meta"> • </span>
  
    <a href="/gastonguay_compsysmed_labnotebook/tags.html#project2" title="Pages tagged project2" rel="tag" class = "tag"> project2 </a>  &nbsp
  
    <a href="/gastonguay_compsysmed_labnotebook/tags.html#static_network" title="Pages tagged static_network" rel="tag" class = "tag"> static_network </a>  &nbsp
  
  

  </li>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="relatedPost">
  <a href="/gastonguay_compsysmed_labnotebook/_projects/project2/2020/03/29/NetworkAnlysis3.html">Network Analysis
  </a> <span class = "post-meta"> • March 29, 2020</span>
  
  <span class = "post-meta"> • </span>
  
    <a href="/gastonguay_compsysmed_labnotebook/tags.html#project2" title="Pages tagged project2" rel="tag" class = "tag"> project2 </a>  &nbsp
  
    <a href="/gastonguay_compsysmed_labnotebook/tags.html#static_network" title="Pages tagged static_network" rel="tag" class = "tag"> static_network </a>  &nbsp
  
  

  </li>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="relatedPost">
  <a href="/gastonguay_compsysmed_labnotebook/_projects/project2/2020/01/28/SFA-exploration.html">Exploration of the Uses and Applications of SFA
  </a> <span class = "post-meta"> • January 28, 2020</span>
  
  <span class = "post-meta"> • </span>
  
    <a href="/gastonguay_compsysmed_labnotebook/tags.html#project2" title="Pages tagged project2" rel="tag" class = "tag"> project2 </a>  &nbsp
  
    <a href="/gastonguay_compsysmed_labnotebook/tags.html#static_network" title="Pages tagged static_network" rel="tag" class = "tag"> static_network </a>  &nbsp
  
  

  </li>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="relatedPost">
  <a href="/gastonguay_compsysmed_labnotebook/_projects/project2/2019/12/20/SFA-test.html">Preliminary SFA Exploration
  </a> <span class = "post-meta"> • December 20, 2019</span>
  
  <span class = "post-meta"> • </span>
  
    <a href="/gastonguay_compsysmed_labnotebook/tags.html#project2" title="Pages tagged project2" rel="tag" class = "tag"> project2 </a>  &nbsp
  
    <a href="/gastonguay_compsysmed_labnotebook/tags.html#static_network" title="Pages tagged static_network" rel="tag" class = "tag"> static_network </a>  &nbsp
  
  

  </li>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  </ul>
  
</div>



<div class="wrapper">


<div class = "turn" style = " right: 0px" >
 <a rel = "next" href="/gastonguay_compsysmed_labnotebook/_projects/project2/2019/09/16/insilico-screening.html"> <span> &rsaquo; </span></a>
</div>





<div class = "turn" style = " left: 0px" >
 <a rel = "prev" href="/gastonguay_compsysmed_labnotebook/_projects/project2/2019/07/12/identify-RON.html"> <span> &lsaquo; </span></a>
</div>



</div>


      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">Maddie Gastonguay lab notebook</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
        <ul class="contact-list">
          <li>Maddie Gastonguay lab notebook</li>
          <li><a href="mailto:madeleine.gastonguay@uconn.edu">madeleine.gastonguay@uconn.edu</a></li>
        </ul>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/VeraLiconaResearchGroup">
              <span class="icon  icon--github">
                <svg viewBox="0 0 16 16">
                  <path fill="$grey-color-light" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                </svg>
              </span>

              <span class="username">VeraLiconaResearchGroup</span>
            </a>
          </li>
          

          


<li>
  <a href="/gastonguay_compsysmed_labnotebook/feed.xml">
    <span class="icon icon-feed">
      <svg viewBox="0 0 16 16">
      <circle cx="3" cy="13" r="2" fill="$grey-color-light" />
        <path fill="$grey-color-light" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" d="M8.5,14.5"/>
        <path fill="$grey-color-light"  d="M8.708,15c-0.552,0-1-0.447-1-1c0-3.147-2.561-5.708-5.708-5.708c-0.552,0-1-0.448-1-1s0.448-1,1-1
          c4.25,0,7.708,3.458,7.708,7.708C9.708,14.553,9.261,15,8.708,15L8.708,15z"/>
        <path fill="$grey-color-light"  d="M13.469,14.999c-0.553,0-1-0.447-1-1C12.469,8.227,7.772,3.531,2,3.531c-0.552,0-1-0.448-1-1s0.448-1,1-1
          c6.875,0,12.469,5.593,12.469,12.468C14.469,14.552,14.021,14.999,13.469,14.999L13.469,14.999z"/>
      </svg>
    </span>
    <span class="feed"> RSS feed </span>
  </a>
</li>



        </ul>
      </div>

      <div class="footer-col  footer-col-3">
        <p class="text">This is my lab notebook for my undergraduate honors thesis in Dr. Paola Vera-Licona's Computational Systems Medicine Research Group.
</p>

      <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0;" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a>

      <p class="text"><span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">Maddie Gastonguay lab notebook</span> by <a xmlns:cc="http://creativecommons.org/ns#" href="http://localhost:4000" property="cc:attributionName" rel="cc:attributionURL">MadeleineGastonguay</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</p>

      </div>



    </div>

  </div>

</footer>


  </body>

</html>
