# -----------------------
# combine_protein_seqs.py takes the separate reference and mutated protein sequences generated by VEP
# with the protein seqs plug-in and combines them into one file, complete.fa, with reference sequences
# labeled as <trasncript>_reference and mutant sequences labeled as <transcript>:p.<mutation>.
# -----------------------

import re
def main():
    ref=open('ref1.fa').read()
    mut=open('mut1.fa').read()
    mut=re.sub('..?:', ':', mut)
    ref1=ref.split('\n')
    mut1=mut.split('\n')
    complete=[]
    for lineref in ref1: 
        if '>' in lineref:
            seqref=ref1[ref1.index(lineref)+1]
            for linemut in mut1:
                thing=linemut.split(':')
                ID=thing[0]
                if '>' in linemut:
                    seqmut=mut1[mut1.index(linemut)+1]
                if lineref==ID:
                    if seqref!=seqmut:
                        complete.append(lineref+'_reference')
                        complete.append(seqref)
                        complete.append(linemut)
                        complete.append(seqmut)
    with open('complete.fa', 'w') as f:
        for item in complete:
            f.write("%s\n" % item)
main()
