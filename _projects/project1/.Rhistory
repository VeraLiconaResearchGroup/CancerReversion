varlist<-list(network$V1)
for (i in varlist){
ilen<-length(i)
x<-length(intersect(i,HOC$X1))/ilen
y<-length(intersect(i,breastDO$X1))/ilen
z<-length(intersect(i,CL$X1))/ilen
a<-length(intersect(i,HOC$X1))
b<-length(intersect(i,breastDO$X1))
c<-length(intersect(i,CL$X1))
SUM<-((1/3)*x)+((1/3)*y)+((1/3)*z)
weightedsums[nrow(weightedsums)+1,] = list(NA,ilen, a, x, b, y, c, z,SUM)
}
weightedsums<-weightedsums[-1,]
weightedsums[1,1]<-'Network'
weightedsums
library(formattable)
forrmattable(weightedsums)
formattable(weightedsums)
formattable(weightedsums)
# write.table(weightedsums,"gene_network/weightedsums_network.txt", row.names=FALSE, quote = FALSE)
tt <- ttheme_default(colhead=list(fg_params = list(fontface=c( "bold"))),
# fg_params=list(fontface=c(rep("plain", 4), "bold.italic")),
base_size = 7.5,
padding = unit(c(2, 4), "mm"))
test <- formattable(weightedsums)
test
test  %>% select(test, everything()) %>%
kable(escape = F) %>%
kable_styling("hover", full_width = F) %>%
column_spec(5, width = "3cm") %>%
add_header_above(c(" ", "OC" = 2, "breastDO" = 2, "CLgenes" = 2, " "))
library(kableExtra)
test  %>% select(test, everything()) %>%
kable(escape = F) %>%
kable_styling("hover", full_width = F) %>%
column_spec(5, width = "3cm") %>%
add_header_above(c(" ", "OC" = 2, "breastDO" = 2, "CLgenes" = 2, " "))
weighted sums %>% select(everything()) %>%
weightedsums %>% select(everything()) %>%
kable(escape = F) %>%
kable_styling("hover", full_width = F) %>%
column_spec(5, width = "3cm") %>%
add_header_above(c(" ", "OC" = 2, "breastDO" = 2, "CLgenes" = 2, " "))
weightedsums %>% select(everything()) %>%
kable(escape = F) %>%
kable_styling("hover", full_width = F) %>%
column_spec(5, width = "3cm")# %>%
add_header_above(c(" ", " ", "HOC" = 2, "breastDO" = 2, "CLgenes" = 2, " "))
weightedsums %>% select(everything()) %>%
kable(escape = F) %>%
kable_styling("hover", full_width = F) %>%
column_spec(5, width = "3cm") %>%
add_header_above(c(" ", " ", "HOC" = 2, "breastDO" = 2, "CLgenes" = 2, " "))
len(names(weightedsums))
length(names(weightedsums))
test <- weightedsums %>% select(everything()) %>%
kable(escape = F) %>%
kable_styling("hover", full_width = F) %>%
column_spec(5, width = "3cm")
length(names(test))
test
weightedsums %>% select(everything()) %>%
kable(escape = F) %>%
kable_styling("hover", full_width = F) %>%
column_spec(5, width = "3cm") %>%
add_header_above(c(" ", " ", "HOC" = 2, "breastDO" = 2, "CLgenes" = 2, " ", " "))
weightedsums %>% select(everything()) %>%
kable(escape = F) %>%
kable_styling("hover", full_width = F) %>%
column_spec(5, width = "3cm") %>%
add_header_above(c(" ", " ", " ", "HOC" = 2, "breastDO" = 2, "CLgenes" = 2, " "))
weightedsums<-data.frame(gene_set = NA, total_number = NA, number = NA, percent= NA, number = NA, percent= NA, number = NA, percent=NA, sum=NA)
class(weightedsums$sum)<-'numeric'
varlist<-list(network$V1)
for (i in varlist){
ilen<-length(i)
x<-length(intersect(i,HOC$X1))/ilen
y<-length(intersect(i,breastDO$X1))/ilen
z<-length(intersect(i,CL$X1))/ilen
a<-length(intersect(i,HOC$X1))
b<-length(intersect(i,breastDO$X1))
c<-length(intersect(i,CL$X1))
SUM<-((1/3)*x)+((1/3)*y)+((1/3)*z)
weightedsums[nrow(weightedsums)+1,] = list(NA,ilen, a, x, b, y, c, z,SUM)
}
weightedsums<-weightedsums[-1,]
weightedsums[1,1]<-'Network'
weightedsums
weightedsums %>% select(everything()) %>%
kable(escape = F) %>%
kable_styling("hover", full_width = F) %>%
column_spec(5, width = "3cm") %>%
add_header_above(c(" ", " ", " ", "HOC" = 2, "breastDO" = 2, "CLgenes" = 2, " "))
names(weightedsums) <- c("gene_set", "total_number", "number", "percent" , "number", "percent", "number", "percent")
weightedsums
names(weightedsums) <- c("gene_set", "total_number", "number", "percent" , "number", "percent", "number", "percent", "sum")
test <- formattable(weightedsums)
names(weightedsums) <- c("gene_set", "total_number", "number", "percent" , "number", "percent", "number", "percent", "sum")
weightedsums %>% select(everything()) %>%
kable(escape = F) %>%
kable_styling("hover", full_width = F) %>%
column_spec(5, width = "3cm") %>%
add_header_above(c(" ", " ", " ", "HOC" = 2, "breastDO" = 2, "CLgenes" = 2, " "))
weightedsums %>%
add_header_above(c(" ", " ", " ", "HOC" = 2, "breastDO" = 2, "CLgenes" = 2, " "))
weightedsums<-data.frame(gene_set = NA, total_number = NA, number = NA, percent= NA, number = NA, percent= NA, number = NA, percent=NA, sum=NA)
class(weightedsums$sum)<-'numeric'
varlist<-list(network$V1)
for (i in varlist){
ilen<-length(i)
x<-length(intersect(i,HOC$X1))/ilen
y<-length(intersect(i,breastDO$X1))/ilen
z<-length(intersect(i,CL$X1))/ilen
a<-length(intersect(i,HOC$X1))
b<-length(intersect(i,breastDO$X1))
c<-length(intersect(i,CL$X1))
SUM<-((1/3)*x)+((1/3)*y)+((1/3)*z)
weightedsums[nrow(weightedsums)+1,] = list(NA,ilen, a, x, b, y, c, z,SUM)
}
weightedsums<-weightedsums[-1,]
weightedsums[1,1]<-'Network'
test <- formattable(weightedsums)
weightedsums %>% select(everything()) %>%
kable(escape = F) %>%
kable_styling("hover", full_width = F) %>%
column_spec(5, width = "3cm") %>%
add_header_above(c(" ", " ", " ", "HOC" = 2, "breastDO" = 2, "CLgenes" = 2, " "))
# write.table(weightedsums,"gene_network/weightedsums_network.txt", row.names=FALSE, quote = FALSE)
tt <- ttheme_default(colhead=list(fg_params = list(fontface=c( "bold"))),
# fg_params=list(fontface=c(rep("plain", 4), "bold.italic")),
base_size = 7.5,
padding = unit(c(2, 4), "mm"))
tbl <- tableGrob(weightedsums, rows=NULL, theme = tt)
weightedsums$rounded_sum <- round(weightedsums$sum, 4)
g1 <- ggplot(data= weightedsums, aes(x = gene_set, y =sum)) + geom_bar(stat="identity", aes(fill = gene_set)) +
geom_text(aes(label = rounded_sum), vjust=1.6, color="white", size=3.5) +
ggtitle("Gene List Weighted Sums") + xlab("Gene list") +ylab("Weighted Sum") + theme(legend.position = "none")
# ggsave("../../_assets/images/weightedsums_plusTABLE.png", arrangeGrob(g1, tbl, nrow = 2, heights = c(3,1)), "png")
# ggsave("../../_assets/images/weightedsums.png", g1, "png")
test <- weightedsums %>% select(everything()) %>%
kable(escape = F) %>%
kable_styling("hover", full_width = F) %>%
column_spec(5, width = "3cm") %>%
add_header_above(c(" ", " ", " ", "HOC" = 2, "breastDO" = 2, "CLgenes" = 2, " "))
weightedsums<-data.frame(gene_set = NA, total_number = NA, number = NA, percent= NA, number = NA, percent= NA, number = NA, percent=NA, sum=NA)
class(weightedsums$sum)<-'numeric'
varlist<-list(network$V1)
for (i in varlist){
ilen<-length(i)
x<-length(intersect(i,HOC$X1))/ilen
y<-length(intersect(i,breastDO$X1))/ilen
z<-length(intersect(i,CL$X1))/ilen
a<-length(intersect(i,HOC$X1))
b<-length(intersect(i,breastDO$X1))
c<-length(intersect(i,CL$X1))
SUM<-((1/3)*x)+((1/3)*y)+((1/3)*z)
weightedsums[nrow(weightedsums)+1,] = list(NA,ilen, a, x, b, y, c, z,SUM)
}
weightedsums<-weightedsums[-1,]
weightedsums[1,1]<-'Network'
test <- formattable(weightedsums)
test <- weightedsums %>% select(everything()) %>%
kable(escape = F) %>%
kable_styling("hover", full_width = F) %>%
column_spec(5, width = "3cm") %>%
add_header_above(c(" ", " ", " ", "HOC" = 2, "breastDO" = 2, "CLgenes" = 2, " "))
# write.table(weightedsums,"gene_network/weightedsums_network.txt", row.names=FALSE, quote = FALSE)
tt <- ttheme_default(colhead=list(fg_params = list(fontface=c( "bold"))),
# fg_params=list(fontface=c(rep("plain", 4), "bold.italic")),
base_size = 7.5,
padding = unit(c(2, 4), "mm"))
tbl <- tableGrob(weightedsums, rows=NULL, theme = tt)
weightedsums$rounded_sum <- round(weightedsums$sum, 4)
g1 <- ggplot(data= weightedsums, aes(x = gene_set, y =sum)) + geom_bar(stat="identity", aes(fill = gene_set)) +
geom_text(aes(label = rounded_sum), vjust=1.6, color="white", size=3.5) +
ggtitle("Gene List Weighted Sums") + xlab("Gene list") +ylab("Weighted Sum") + theme(legend.position = "none")
# ggsave("../../_assets/images/weightedsums_plusTABLE.png", arrangeGrob(g1, tbl, nrow = 2, heights = c(3,1)), "png")
# ggsave("../../_assets/images/weightedsums.png", g1, "png")
names(test)
col.names(test)
weightedsums %>% select(everything()) %>%
kable(escape = F) %>%
kable_styling("hover", full_width = F) %>%
column_spec(5, width = "3cm") %>%
add_header_above(c(" ", " ", " ", "HOC" = 2, "breastDO" = 2, "CLgenes" = 2, " "))
weightedsums<-data.frame(gene_set = NA, total_number = NA, number = NA, percent= NA, number = NA, percent= NA, number = NA, percent=NA, sum=NA)
class(weightedsums$sum)<-'numeric'
varlist<-list(network$V1)
for (i in varlist){
ilen<-length(i)
x<-length(intersect(i,HOC$X1))/ilen
y<-length(intersect(i,breastDO$X1))/ilen
z<-length(intersect(i,CL$X1))/ilen
a<-length(intersect(i,HOC$X1))
b<-length(intersect(i,breastDO$X1))
c<-length(intersect(i,CL$X1))
SUM<-((1/3)*x)+((1/3)*y)+((1/3)*z)
weightedsums[nrow(weightedsums)+1,] = list(NA,ilen, a, x, b, y, c, z,SUM)
}
weightedsums<-weightedsums[-1,]
weightedsums[1,1]<-'Network'
test <- formattable(weightedsums)
weightedsums %>% select(everything()) %>%
kable(escape = F) %>%
kable_styling("hover", full_width = F) %>%
column_spec(5, width = "3cm") %>%
add_header_above(c(" ", " ", " ", "HOC" = 2, "breastDO" = 2, "CLgenes" = 2, " "))
table <- weightedsums %>% select(everything()) %>%
kable(escape = F) %>%
kable_styling("hover", full_width = F) %>%
column_spec(5, width = "3cm") %>%
add_header_above(c(" ", " ", " ", "HOC" = 2, "breastDO" = 2, "CLgenes" = 2, " "))
ggsave(table)
df <- weightedsums %>% select(everything()) %>%
kable(escape = F) %>%
kable_styling("hover", full_width = F) %>%
column_spec(5, width = "3cm") %>%
add_header_above(c(" ", " ", " ", "HOC" = 2, "breastDO" = 2, "CLgenes" = 2, " "))
png("test.png", height=1000, width=200)
p<-tableGrob(df)
grid.arrange(p)
dev.off()
png(df, "test.png", height=1000, width=200)
p<-tableGrob(df)
png("test.png", height=1000, width=200)
p<-tableGrob(df)
grid.arrange(p)
dev.off()
getwd()
intersect(netwrok$V1,HOC$X1)
intersect(network$V1,HOC$X1)
HOCint <- as.data.frame(intersect(network$V1,HOC$X1))
HOCint
CLint <- as.data.frame(intersect(network$V1, CL$X1))
DOint <- as.data.frame(intersect(network$V1, breastDO$X1))
write_tsv(HOCint, "netowrk_int_HOC.txt", row.names = FALSE)
?write_tsv
write_tsv(HOCint, "netowrk_int_HOC.txt", col_names = FALSE)
write_tsv(HOCint, "../gene_network/netowrk_int_HOC.txt", col_names = FALSE)
setwd("~/Documents/GitHub/gastonguay_compsysmed_labnotebook/_projects/project1")
write_tsv(HOCint, "../gene_network/netowrk_int_HOC.txt", col_names = FALSE)
write_tsv(HOCint, "../gene_network/network_int_HOC.txt", col_names = FALSE)
write_tsv(HOCint, "gene_network/network_int_HOC.txt", col_names = FALSE)
write_tsv(CLint, "gene_network/network_int_CLgenes.txt", col_names = FALSE)
write_tsv(DOint, "gene_network/network_int_breastDO.txt", col_names = FALSE)
df <- weightedsums %>% select(everything()) %>%
kable(escape = F) %>%
kable_styling("hover", full_width = F) %>%
column_spec(5, width = "3cm") %>%
add_header_above(c(" ", " ", " ", "HOC" = 2, "breastDO" = 2, "CLgenes" = 2, " "))
df
#Load libraries
library(tidyverse)
setwd("~/Documents/GitHub/gastonguay_compsysmed_labnotebook/_projects/project1")
#read in desired nodes
nodes <- read.csv("nodes_test.csv", header = FALSE) %>% t()
setwd("~/Desktop")
#read in desired nodes
nodes <- read.csv("nodes_test.csv", header = FALSE) %>% t()
?read.csv
#read in desired nodes
nodes <- read.csv("nodes_test.csv", header = FALSE) %>% t()
nodes <- read.csv("nodes_test.csv", header = FALSE)
#read in CRISPR data
crsipr <- read.csv("crispr_test.csv", header = FALSE)
#read in CRISPR data
crsipr <- read.csv("crsipr_test.csv", header = FALSE)
crsipr
#read in CRISPR data
crsipr <- read.csv("crsipr_test.csv")
crsipr
nodes
#read in desired nodes
nodes <- read.csv("nodes_test.csv", header = FALSE) %>% t()
nodes
#read in desired nodes
nodes <- read.csv("nodes_test.csv", header = FALSE, row.names = TRUE) %>% t()
nodes
nodes <- read.csv("nodes_test.csv", header = FALSE, row.names = TRUE)
nodes
nodes <- read.csv("nodes_test.csv")
nodes
#read in desired nodes
nodes <- read.csv("nodes_test.csv", header = FALSE) %>% t()
nodes
nodes <- read.csv("nodes_test.csv", header = FALSE)
nodes
nodes
#read in desired nodes
nodes <- read.csv("nodes_test.csv", header = FALSE) %>% t() %>% as.data.frame()
nodes
?as.data.frame()
#read in desired nodes
nodes <- read.csv("nodes_test.csv", header = FALSE)
nodes
nodes <- nodes%>% t() %>% as.data.frame(col.names = nodes$V1)
nodes
nodes <- nodes %>% t() %>% as.data.frame(col.names = nodes$V1)
nodes
nodes$V1
typeof(nodes$V1)
nodes <- nodes %>% t() %>% as.data.frame(col.names = c(nodes$V1))
nodes
nodes$V1
_
#read in desired nodes
nodes <- read.csv("nodes_test.csv", header = FALSE)
nodes$V1
c(nodes$V1)
setwd("~/Documents/GitHub/gastonguay_compsysmed_labnotebook/_projects/project1")
?read_tsv
nodes <- read_tsv("Crispr_nodes.txt", col_names = FALSE)
nodes
getwd()
#read in CRISPR data
crsipr <- read.csv("/Users/Maddie/Desktop/Achilles_gene_effect.csv")
head(crsipr)
names(crsipr)
nodes
nodes <- read_tsv("Crispr_nodes.txt", col_names = FALSE)
crsipr$X
crsipr$X["ACH-000768"]
crsipr$X[ACH-000768]
crsipr$X[349]
crsipr$X[349,]
crsipr$X[,349]
test <- crsipr$X
test <- as.data.frame(crsipr$X)
test[349]
test[349,]
test <- as.data.frame(crsipr$ABL1..25.)
test[349,]
for (node in nodes)
{
if (node in names(crispr))
{
df$node <- crsipr$node[349,]
}
}
for (i in nodes)
{
if (i in names(crispr))
{
df$i <- crsipr$i[349,]
}
}
typeof(nodes)
for (i in nodes)
{
print(1)
}
names(nodes)
nodes
for (i in str(nodes)
print(1)
{
print(1)
}
for (i in str(nodes))
{
print(1)
}
names(crispr)
names(crsipr)
typeof(names(crsipr))
typeof(c(names(crsipr)))
c(names(crsipr))
head(crsipr)
head(crispr[,3])
head(crsipr[,3])
head(crsipr[3,])
typeof(nodes)
df1<-data.frame(data2[349, crsipr(names) %in% nodes])
df1<-data.frame(crsipr[349, crsipr(names) %in% nodes])
df1<-data.frame(crsipr[349, names(crsipr) %in% nodes])
View(df1)
df1<-data.frame(crsipr[349, ])
View(df1)
names <- as.data.frame(names(crsipr))
names
test_set <- data.frame(names[names$`names(crsipr)` %in% nodes,])
View(test_set)
nodes
test_set <- data.frame(names[names$`names(crsipr)` %in% nodes$X1,])
View(test_set)
df1<-data.frame(crsipr[349, names$`names(crsipr)` %in% nodes$X1 ])
View(df1)
names
test <- names$`names(crsipr)` %in% nodes$X1
typeof(test)
crsipr$ABL1..25.
crsipr$AKT1..207.
crsipr$X[349]
df2 <- df1%>% t() %>% as.data.frame()
df2
names(df2) <- "231"
df2
names(df2) <- "MDA231"
head(df2)
write_tsv(df2, "CrisprData_231.txt")
getwd()
write_tsv(df2, "CrisprData_231.txt", col.names= TRUE)
write_tsv(df2, "CrisprData_231.txt", row.names= TRUE)
write_tsv(df2, "CrisprData_231.txt", row.names= FALSE)
write.csv(df2, "CrisprData_231.txt", row.names= FALSE)
df1
names(df1)
df2$names <- names(df1)
df2
df2 <- df1%>% t() %>% as.data.frame()
df2
df2$nodes <- names(df1)
f2
df2 <- df1%>% t() %>% as.data.frame()
df3$nodes <- names(df1)
df2$nodes <- names(df1)
df2
names(df2) <- c("MDA231", "Node")
head(df2)
write_tsv(df2, "CrisprData_231.txt", row.names= FALSE)
write_tsv(df2, "CrisprData_231.txt")
df3 <- df2[,c("Node", "MDA231")]
head(df3)
#read in CRISPR data
crispr <- read.csv("/Users/Maddie/Desktop/gene_dependency.csv")
names <- as.data.frame(names(crsipr))
head(crispr)
names <- as.data.frame(names(crispr))
names
df1<-data.frame(crsipr[349, names$`names(crispr)` %in% nodes$X1 ])
names(df1)
df2 <- df1%>% t() %>% as.data.frame()
df2$nodes <- names(df1)
names(df2) <- c("MDA231", "Node")
df3 <- df2[,c("Node", "MDA231")]
df3
crispr$X
df1<-data.frame(crsipr["ACH-000768", names$`names(crispr)` %in% nodes$X1 ])
df1
crispr["ACH-000768",]
crispr$X
crispr$X[359,]
crispr$X[359]
df1<-data.frame(crsipr[359, names$`names(crispr)` %in% nodes$X1 ])
df1<-data.frame(crsipr[359, names$`names(crispr)` %in% nodes$X1 ])
names(df1)
df2 <- df1%>% t() %>% as.data.frame()
df2$nodes <- names(df1)
names(df2) <- c("MDA231", "Node")
df3 <- df2[,c("Node", "MDA231")]
df3
write_tsv(df3, "CrisprData_231_gene_dependency.txt")
?read.csv
head(crispr)
#################### take 2 ################
crispr <- read.csv("/Users/Maddie/Desktop/gene_dependency.csv", row.names =1)
head(crispr)
names(crispr)
colnames(crispr)
rownames(crispr)
crispr$ABL1..25.$["ACH-000768"]
crispr$ABL1..25.["ACH-000768"]
crispr$ABL1..25.
crispr$ABL1..25.["ACH-000768",]
df1<-data.frame(crsipr["ACH-000768", names$`names(crispr)` %in% nodes$X1 ])
names(df1)
rownames(df1)
df2 <- df1%>% t() %>% as.data.frame()
df2$nodes <- names(df1)
names(df2) <- c("MDA231", "Node")
df2
#################### take 2 ################
crispr <- read.csv("/Users/Maddie/Desktop/gene_dependency.csv")
names <- as.data.frame(names(crispr))
df1<-data.frame(crsipr[359, names$`names(crispr)` %in% nodes$X1 ])
names(df1)
df2 <- df1%>% t() %>% as.data.frame()
df2$nodes <- names(df1)
names(df2) <- c("MDA231", "Node")
df3 <- df2[,c("Node", "MDA231")]
write_tsv(df3, "CrisprData_231_gene_dependency.txt")
?read_delim
test <- data.frame(crsipr[, names$`names(crispr)` %in% nodes$X1 ])
rownames(crispr)
cripsr$X
crispr$X
test <- data.frame(crsipr[, names$`names(crispr)` %in% nodes$X1 ]) %>% filter(crispr$X == "ACH-000768")
crispr$X == "ACH-000768"
test <- data.frame(crsipr[, names$`names(crispr)` %in% nodes$X1 ]) %>% filter(crispr$X == ACH-000768)
names <- as.data.frame(names(crispr))
df1<-data.frame(crsipr[359, names$`names(crispr)` %in% nodes$X1 ])
names(df1)
df2 <- df1%>% t() %>% as.data.frame()
df2$nodes <- names(df1)
names(df2) <- c("MDA231", "Node")
df3 <- df2[,c("Node", "MDA231")]
test <- data.frame(crsipr[, names$`names(crispr)` %in% nodes$X1 ]) %>% filter(crispr$X == "ACH-000768")
test <- data.frame(crsipr[, names$`names(crispr)` %in% nodes$X1 ])
test %>% filter(crispr$X == "ACH-000768")
test <- tbl_df(crsipr[, names$`names(crispr)` %in% nodes$X1 ])
test %>% filter(crispr$X == "ACH-000768")
test %>% filter(X == "ACH-000768")
test %>% filter("X" == "ACH-000768")
test <- as.data.frame(crsipr[, names$`names(crispr)` %in% nodes$X1 ])
test %>% filter("X" == "ACH-000768")
test2 <- test %>% filter("X" == "ACH-000768")
View(test2)
install.packages("NMF")
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(NMF)
install.packages("rngtools")
